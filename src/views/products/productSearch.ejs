<%- include('../partials/head') %>

<!-- JS FRONT DE BUSCADOR POR CATEGORIAS -->
<script src="/js/subcategorysearch.js" defer></script>
<!-- CONVERSION DE TABLAS DE BASE DE DATOS PARA PODER SER USADAS EN JSFRONT -->
<script type="text/javascript" defer>
    let categories = '<%-JSON.stringify(categories)%>'
    let subcategories = '<%-JSON.stringify(subcategories)%>';
</script>

<body>
    
    <!-- HEADER -->
    <%- include('../partials/header') %>
    
    <!-- FIN HEADER -->

    
        
    <!-- Submenú de categorías de productos -->
        <section class="productSearch__category">
            <article>
                <select id="select-category">
                    <option value="">CATEGORÍA</option>
                    <% categories.forEach(cat => { %>
                        <option value="<%=cat.id%>"><%=cat.name%></option>
                    <% }) %>
                </select>
            </article>    

    <!-- Submenu de Subcategorias oculto hasta que se selecciona una categoria -->
            <article>
                <form  id="subcatsearch" name="subcatsearch" action="/products" method="POST">
                <select name="query" id="select-subcat">
                    <option value="">SUBCATEGORÍA</option>
                </select>
                </form>       
            </article>

        </section>
    
    <!-- Informacion buscada si se usó el buscador del header o de subcategorias -->

        <% if (typeof query != "undefined") { %>
     
            <section class="productSearch__category">
                <article>
                    <%=query%>
                </article>
            </section>
        <% } %>


    <!-- Comienza main content -->
    <div class="productSearch__main__content">

        <!-- Productos buscados -->
        <div class="productSearch__product__grid">
            
            <% products.forEach(product => { %>
            <article class="productSearch__single__product">
                <a href="/products/<%= product.id %>"><img src="/images/products/<%= product.image %>" alt="<%=product.name%>"></a>
                <a href="/products/<%= product.id %>" class="productSearch__name"><h1><%= product.name %> <%=product.size.value%></h1></a>
                <p class="productSearch__price">$ <%= product.price %></p>
                <form action="/products/cart" method="GET">
                <button type="submit">COMPRAR</button>
                </form>
            </article>
        <% }) %>

        </div>

    </div>
    <!-- footer -->
    <%- include('../partials/footer') %>
    <!-- Fin footer -->
</body>
</html>